attack_technique: T1566.001
display_name: 'Phishing: Spearphishing Attachment'
atomic_tests:
  - name: Simulate sending a phishing email with a malicious attachment via SMTP
    auto_generated_guid: custom-guid-phishing-attachment
    description: |
      This test simulates sending a phishing email with a malicious attachment using PowerShell.
      WARNING: THIS IS A SIMULATION AND SHOULD ONLY BE RUN IN A CONTROLLED ENVIRONMENT.
    supported_platforms:
      - windows
    input_arguments:
      smtp_server:
        description: SMTP server to use
        type: string
        default: "localhost"  # Serveur SMTP local
      smtp_port:
        description: SMTP port
        type: integer
        default: 25  # Port SMTP standard (pas besoin de TLS)
      sender_email:
        description: Real email address for SMTP authentication
        type: string
        default: ""  # Pas nécessaire avec SMTP local
      sender_visible_email:
        description: Email address visible in the "From" field
        type: string
        default: "chaymabouattour1@gmail.com"  # Adresse visible par le destinataire (peut être falsifiée)
      recipient_email:
        description: Recipient email address
        type: string
        default: "oumaymakabadou2@gmail.com"  # Destinataire réel
      subject:
        description: Customized subject of the email
        type: string
        default: "⚠️ Urgent: Please review the attached document"
      body:
        description: Customized body of the email
        type: string
        default: |
          Dear User,<br>
          We have detected unusual activity on your account. To secure your data, please review the attached document as soon as possible.<br>
          Thank you for your cooperation.<br>
          Best regards,<br>
          The Security Team
      attachment_path:
        description: Path to the attachment (generated by T1027)
        type: string
        default: "C:\\temp\\PhishingAttachement.xlsm"  # Chemin du fichier Excel avec macros
      app_password:
        description: Application password for SMTP authentication
        type: string
        default: ""  # Pas nécessaire avec SMTP local
      log_file:
        description: Path to the log file
        type: string
        default: "C:\\Users\\chaym\\phishing_script.log"
